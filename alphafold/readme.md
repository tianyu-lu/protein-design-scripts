Code adapted from https://github.com/sokrypton/ColabDesign/blob/eadea7a27f132b7bc6fe0def6b6dab2089eaf554/af/design.py#L1
